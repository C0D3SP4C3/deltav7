"use strict";(self.webpackChunkdeltav4=self.webpackChunkdeltav4||[]).push([[905],{4905:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Q});var r=a(8967),i=a(8499),l=a(4977),o=a(6524),s=a(8175),n=a(2267),c=a(340);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function u(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return v(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){s=!0,l=e},f:function(){try{o||null==a.return||a.return()}finally{if(s)throw l}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function g(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function f(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function y(){var e=this;function t(){e.initialized&&(e.resizeCanvas(e.stage.canvasWidth,e.stage.canvasHeight,e.stage.canvasStyleWidth,e.stage.canvasStyleHeight),e.setCanvasAntialiasing(Number(n.Xd.raw.antialiasing.value)))}1!=this.initialized&&(this.initialized=!0,this.setCanvas(),this.listenTo(this.stage,"resize",(function(){o.X.once("update",t)}))(),this.listenTo(n.Xd,"antialiasing",(function(){e.initialized&&e.setCanvasAntialiasing(Number(n.Xd.raw.antialiasing.value))})),this.listenTo(this.stage,"render",(function(t){return e.render(t)})))}function w(){this.initialized,this.unlisten(),this.canvas.parentElement.removeChild(this.canvas)}function S(e){return e.preventDefault()}function m(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d",{antialias:!1}),document.querySelector(".canvas-container").appendChild(this.canvas),this.canvas.classList.add("canvas"),this.canvas.addEventListener("contextmenu",S)}function b(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.canvas.style.imageRendering=e?"":"pixelated"}function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(void 0!==(e=Number(e)))switch(this.ctx.imageSmoothingEnabled=!0,e){case 0:this.ctx.imageSmoothingEnabled=!1,this.ctx.imageSmoothingQuality="low",this.setCanvasSmoothing(!1);break;case 1:this.ctx.imageSmoothingQuality="low",this.setCanvasSmoothing(!0);break;case 2:this.ctx.imageSmoothingQuality="medium",this.setCanvasSmoothing(!0);break;case 3:this.ctx.imageSmoothingQuality="high",this.setCanvasSmoothing(!0);break;case 4:this.ctx.imageSmoothingQuality="high",this.setCanvasSmoothing(!1)}}function x(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500;this.canvasWidth=e,this.canvasHeight=t,this.canvas.style.width=a+"px",this.canvas.style.height=r+"px",this.canvas.width=e,this.canvas.height=t}function k(e,t,a,r){}function T(e,t,a,r,i,l){if(r>=.1){var o=t/r,s=a/r,c=(o/2-i)%50,h=(s/2-l)%50;for(e.lineWidth=1,e.globalAlpha=r>=.1?1*r-.1:0,e.strokeStyle=n.rS.raw.gridColor.string,e.beginPath();c<o;c+=50)e.moveTo(c*r-.5,0),e.lineTo(c*r-.5,s*r);for(;h<s;h+=50)e.moveTo(0,h*r-.5),e.lineTo(o*r,h*r-.5);e.stroke(),e.globalAlpha=1}}function M(e,t,a,r,i,l,o,s){e.strokeStyle=o,e.lineWidth=s,e.fillStyle="white",e.font="100px sans-serif",e.textAlign="end",e.textBaseline="hanging",e.beginPath(),e.moveTo(a,r),e.lineTo(i,r),e.lineTo(i,l),e.lineTo(a,l),e.closePath(),e.stroke(),e.fillText(t,i,r)}function A(){for(var e=this.app.waves,t=e.length;t--;){var a=e[t];if(!(1>a.delta)){var r=a.r*a.delta/a.duration;this.ctx.globalAlpha=333<r?(a.r-r)/a.fadeTime:1;var i=this.ctx.createRadialGradient(a.x,a.y,.7*r,a.x,a.y,r);i.addColorStop(0,"rgba(0,0,0,0)"),i.addColorStop(1,a.color),this.ctx.fillStyle=i,this.ctx.beginPath(),this.ctx.arc(a.x,a.y,r,0,this.pi2,!0),this.ctx.closePath(),this.ctx.fill()}}}function X(e,t,a,r,i,l,o,s,c,h,u,v){if(t){var g=~~((o-i)/a),d=~~((s-l)/r),f=0,p=0;if(e.strokeStyle=c,e.fillStyle=h,e.lineWidth=u,v||!v&&n.Xd.raw.showMiniMapGrid.value){e.beginPath();for(var y=0;y<a+1;y++)f=i+g*y,e.moveTo(y==a?o:f,l),e.lineTo(y==a?o:f,s);for(y=0;y<r+1;y++)p=l+d*y,e.moveTo(i-u/2,y==r?s:p),e.lineTo(o+u/2,y==r?s:p);e.stroke()}else this.drawMapBorders(e,t,i,l,o,s,c,u);e.font=n.rS.raw.sectorsfont.fontWeight+" "+n.rS.raw.sectorsfontSize.value+"px "+n.rS.raw.sectorsfont.fontFamily,e.textAlign="center",e.textBaseline="middle";for(var w=0;w<r;w++)for(var S=0;S<a;S++)if(this.stage.boxInDisplay(i+S*g,l+w*d,g,d)){var m=n.Xd.raw.customBgSectorsSymbol.value||String.fromCharCode(65+w)+(S+1);f=~~(i+g/2+S*g),p=~~(l+d/2+w*d),e.fillText(m,f,p)}}}function P(e,t,a,r,i,l,o,s){e.strokeStyle=o,e.lineWidth=s,e.beginPath(),e.moveTo(a,r),e.lineTo(i,r),e.lineTo(i,l),e.lineTo(a,l),e.closePath(),e.stroke()}function _(e,t,a,r){if(t&&t.length){e.beginPath();for(var i=0;i<t.length;i++){var l=t[i].x,o=t[i].y,s=t[i].size+820;e.moveTo(l,o),e.arc(l,o,s,0,2*Math.PI,!1)}e.fillStyle=n.rS.raw.virusRangeColor.string,e.globalAlpha=.1,e.fill(),e.globalAlpha=1}}function z(e,t,a,r,i,l,o,s,c){var h=this.app.getActiveTab();if(h.battleRoyale.state){var u=(h.battleRoyale.x+l)*s,v=(h.battleRoyale.y+o)*c,g=h.battleRoyale.radius*s;this.drawDangerArea(e,u,v,g,t,a,r,i,n.rS.raw.dangerAreaColor.string,.25),u=~~((h.battleRoyale.targetX+l)*s),v=~~((h.battleRoyale.targetY+o)*c),g=~~(h.battleRoyale.targetRadius*s),this.drawSafeArea(e,u,v,g,20,n.rS.raw.safeAreaColor.string)}}function R(e,t,a,r,i,l,o,s,n,c){var h=this.app.getActiveTab();h.battleRoyale.radius==h.battleRoyale.maxRadius||r<=0||(e.save(),e.globalAlpha=c,e.fillStyle=n,e.fillRect(i,l,o,s),e.globalCompositeOperation="destination-out",e.globalAlpha=1,e.beginPath(),e.arc(t,a,r,0,this.pi2,!1),e.fill(),e.restore())}function O(e,t,a,r,i,l){this.app.getActiveTab().battleRoyale.state>2||r<=0||this.drawDashedCircle(e,t,a,r,60,i,l)}function E(e,t,a,r,i,l,o){var s=this.pi2/i;e.lineWidth=l,e.strokeStyle=o;for(var n=0;n<i;n+=2)e.beginPath(),e.arc(t,a,r-l/2,n*s,(n+1)*s,!1),e.stroke()}function I(e){if(n.Xd.raw.showGhostCells.value){var t=e.ghostCells;this.ctx.beginPath();for(var a=0,r=t.length;a<r;a++)if(!t[a].inView){var l=t[a].x,o=t[a].y;this.stage.isInDisplay(l,o,t[a].size)&&(this.ctx.moveTo(l,o),this.ctx.arc(l,o,t[a].size,0,this.pi2,!1))}this.ctx.fillStyle=n.rS.raw.ghostCellsColor.string,this.ctx.globalAlpha=n.rS.raw.ghostCellsColor.microcolor.vector[3],this.ctx.shadowColor=n.rS.raw.ghostCellsColor.microcolor.string,this.ctx.shadowBlur=40,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0,this.ctx.fill(),this.ctx.globalAlpha=1,this.ctx.shadowBlur=0;for(var s=0,c=t.length;s<c;s++)if(!t[s].inView){var h=t[s].x,u=t[s].y;if(this.stage.isInDisplay(h,u,t[s].size)&&n.Xd.raw.ghostCellsNames.value){var v=i.T.nick(t[s].size,this.stage.scale,n.rS.raw.namesScale.value,t[s].name);if(v){var g=v.originW*t[s].size*n.rS.raw.namesScale.value,d=v.originH*t[s].size*n.rS.raw.namesScale.value;this.ctx.drawImage(v.canvas,h-(g>>1),u-(d>>1),g,d)}}}}}function W(e,t,a,o){var s=this.ctx,h=e.alpha,u=!1,v=0,g=0,d=0,f=0;if(this.stage.scale>.44?(g=e.type===c.bL.Type.food?e.size+n.rS.raw.foodSize.value:e.size,f=e.x,d=e.y):(g=e.type===c.bL.Type.food?e.size+n.rS.raw.foodSize.value:~~e.size,d=~~e.y,f=~~e.x),s.beginPath(),!e.removed&&n.Xd.raw.jellyPhysics.value&&e.points.length&&this.stage.scale>.3&&e.size>35/this.stage.scale){var p=e.points[0];s.moveTo(p.x,p.y);for(var y=0;y<e.points.length;++y)p=e.points[y],s.lineTo(p.x,p.y),e.points[y].rl>v&&(v=e.points[y].rl);s.closePath()}else if(e.type===c.bL.Type.virus&&(n.Xd.raw.spikedViruses.value||n.Xd.raw.jellyPhysics.value)){var w=this.pi2/100;s.moveTo(e.x,e.y+e.size+3);for(var S=1;S<100;S++){var m=S*w,b=e.size-3+6*(S%2==0);s.lineTo(e.x+b*Math.sin(m),e.y+b*Math.cos(m))}s.lineTo(e.x,e.y+e.size+3),s.closePath()}else s.arc(f,d,g,0,this.pi2,!0);if(e.type===c.bL.Type.food)s.fillStyle=e.color,s.globalAlpha=h,s.fill();else if(e.type===c.bL.Type.virus){var C;if(n.Xd.raw.virColors.value&&(null===(C=e.c.unitManager.activeUnit)||void 0===C?void 0:C.play)?(s.fillStyle=this.setVirusColor(e.size).toRgb(!0),s.strokeStyle=this.setVirusStrokeColor(e.size,e.c.unitManager.activeUnit).toRgb()):e.size<=147?(s.fillStyle=n.rS.raw.virusColor.string,s.strokeStyle=n.rS.raw.virusStrokeColor.string):(s.fillStyle=n.rS.raw.mothercellColor.string,s.strokeStyle=n.rS.raw.mothercellStrokeColor.string),1!==e.alpha&&(s.globalAlpha=e.alpha,u=!0),s.fill(),s.lineWidth=n.rS.raw.virusStrokeSize.value,s.stroke(),0===n.Xd.raw.virMassType.value);else if(3===n.Xd.raw.virMassType.value&&e.size<148){var x=3*(e.size-100);x>0&&(s.fillStyle=s.strokeStyle,s.beginPath(),s.arc(e.x,e.y,x,0,this.pi2,!0),s.closePath(),s.fill())}else{var k=~~(e.targetSize*e.targetSize/100),T=i.T.mass(e.id,e.size,this.stage.scale,n.rS.raw.virMassScale.value,2===n.Xd.raw.virMassType.value&&k<200?this.calcVirusShots(k):k,!0);if(T){var M=T.originW*e.size*n.rS.raw.virMassScale.value,A=T.originH*e.size*n.rS.raw.virMassScale.value;s.drawImage(T,~~(e.x-(M>>1)),~~(e.y-(A>>1)),~~M,~~A)}}s.globalAlpha=this.startAlpha}else{1!==e.alpha&&(s.globalAlpha=e.alpha,u=!0);var X=e.isPlayerCell||null!==e.playerOriginUnit,P=e.color;X||e.c.play&&e.oppColor&&n.Xd.raw.oppColors.value&&!n.Xd.raw.oppRings.value&&(P=e.oppColor.string);var _=null;if(r.d8.showAnySkins){if(n.Xd.raw.vanillaSkins.value&&(e.hasVanillaNamedSkin?_=l.x.getVanillaSkin(e.nameSkin):e.hasVanillaCustomSkin?_=l.x.getVanillaCustomSkin(e.skin):e.hasUrlSkin?_=l.x.getUrlSkin(e.skin):e.skin&&(_=l.x.getVanillaSkin(e.skin))),n.Xd.raw.customSkins.value){var z=l.x.getCustomSkin(e.targetNick+e.colorInt);z&&(_=z,z&&z.type===l.B.Types.ANIMATION&&z.animation&&z.animation.isParsed&&(z.animation.move(),z.image=z.animation.c,_.averageColorString=z.animation.averageColorString,_=z))}_&&_.image&&(_.averageColor.a<200&&(s.fillStyle=P,1!==n.rS.raw.cellsAlpha.value?(s.globalAlpha*=n.rS.raw.cellsAlpha.value,s.fill(),s.globalAlpha/=n.rS.raw.cellsAlpha.value):s.fill()),(1!==n.rS.raw.skinsAlpha.value||e.c.play&&n.Xd.raw.oppColors.value)&&1!==n.rS.raw.skinsAlpha.value&&(s.globalAlpha*=n.rS.raw.skinsAlpha.value,u=!0),n.Xd.raw.jellyPhysics.value?this.stage.scale>.3&&e.size>35/this.stage.scale?(s.save(),s.clip(),s.drawImage(_.image,0,0,512,512,e.x-v,e.y-v,2*v,2*v),s.restore()):s.drawImage(_.image,0,0,512,512,~~e.x-~~g,~~e.y-~~g,2*~~g,2*~~g):s.drawImage(_.image,f-g,d-g,2*g,2*g),u&&(s.globalAlpha/=n.rS.raw.skinsAlpha.value,u=!1))}if(_&&_.image||(s.fillStyle=P,1!==n.rS.raw.cellsAlpha.value?(s.globalAlpha*=n.rS.raw.cellsAlpha.value,s.fill(),s.globalAlpha/=n.rS.raw.cellsAlpha.value):s.fill()),n.Xd.raw.cellStroke.value&&e.size>20&&(n.Xd.raw.cellStrokePlayer.value&&X?(s.strokeStyle=_&&_.image?_.averageColorString:e.strokeColor,s.lineWidth=Math.min(Math.max(~~(e.size/50),4),4),s.stroke(),s.strokeStyle="#FEB201",s.lineWidth=Math.min(Math.max(~~(e.size/50),2),2),s.stroke(),s.strokeStyle="#FFF906",s.lineWidth=Math.min(Math.max(~~(e.size/50),1),1),s.stroke()):e.removed||(s.globalAlpha=e.alpha,s.strokeStyle=_&&_.image?_.averageColorString:e.strokeColor,s.lineWidth=Math.min(Math.max(~~(e.size/50),8),8),s.stroke())),n.Xd.raw.teammatesInd.value&&!e.isPlayerCell&&g<=200&&l.x.customSkinMap.has(e.targetNick)&&this.drawTeammatesInd(s,f,d,~~g),n.Xd.raw.mbRings.value&&X&&o&&a){var R=g/100*n.rS.raw.mbRingWidth.value;s.lineWidth=R,s.globalAlpha=h,s.strokeStyle=a.unitId===e.playerOriginUnit.unitId?n.rS.raw.mboxActiveCellStroke.string:n.rS.raw.mboxUnactiveCellStroke.string,s.beginPath(),s.arc(f,d,g-R/2,0,this.pi2,!0),s.closePath(),s.stroke(),s.globalAlpha=1}if(n.Xd.raw.mergeIndicator.value&&a===e.playerOriginUnit){e.calcMerge();var O=e.mergeTimeLeft/e.cellMergeFull*2;if(O>=0){var E=Math.PI*(2-O+1.5),I=3.5*Math.PI,W=g/100*15;s.lineCap="round",s.lineWidth=W,s.globalAlpha=h,s.strokeStyle=n.rS.raw.mergeIndicatorColor.string,s.beginPath(),s.arc(e.x,e.y,g-.5*W,I,E,!0),s.stroke(),s.closePath(),s.lineCap="square",s.globalAlpha=1}}var j=this.setAutoHideCellInfoNick(g),H=this.setAutoHideCellInfoMass(g);if(j&&H||g<=40||e.type==c.bL.Type.virus);else{1!==e.alpha&&(s.globalAlpha=e.alpha);var V=0===n.Xd.raw.textScaleMode.value?e.targetSize:g;if(!j&&n.Xd.raw.showNames.value&&(!X||!n.Xd.raw.hideMyName.value)&&(!_||!n.Xd.raw.hideTeammatesNames.value)){var B=i.T.nick(g,this.stage.scale,n.rS.raw.namesScale.value,e.targetNick);if(B){var D=B.originW*V*n.rS.raw.namesScale.value,F=B.originH*V*n.rS.raw.namesScale.value;s.drawImage(B.canvas,f-D/2,d-F/2,D,F)}}if(!H&&n.Xd.raw.showMass.value&&(!X||!n.Xd.raw.hideMyMass.value)&&(!n.Xd.raw.hideEnemiesMass.value||X)){var Y=i.T.mass(e.id,e.size,this.stage.scale,n.rS.raw.namesScale.value,n.Xd.raw.shortMass.value?this.shortMassFormat(V*V/100):~~(V*V/100),!1);if(Y){var N=Y.originW*V*n.rS.raw.massScale.value/2,U=Y.originH*V*n.rS.raw.massScale.value/2,L=!n.Xd.raw.showNames.value||X&&n.Xd.raw.hideMyName.value?d-U/2:g/4+d;s.drawImage(Y,f-N/2,L,N,U)}}}s.globalAlpha=1}}function j(e,t,a){if(t.foods.length){var r=t.foods,i=~~(10+n.rS.raw.foodSize.value);if(e.beginPath(),e.fillStyle=n.rS.raw.foodColor.string,e.globalAlpha=1,this.stage.scale>.16)for(var l=0,o=r.length;o>l;l++){var s=r[l];this.stage.reverseCheckView(s,a)||(e.moveTo(s.targetX,s.targetY),e.arc(s.targetX,s.targetY,i,0,this.pi2,!1))}else for(var c=0,h=r.length;h>c;c++){var u=r[c];this.stage.reverseCheckView(u,a)||e.rect(~~u.targetX-i,~~u.targetY-i,i<<1,i<<1)}e.closePath(),e.fill()}}function H(e,t,a){if(t.foods.length){var r=t.foods,i=~~(10+n.rS.raw.foodSize.value);if(e.globalAlpha=1,this.stage.scale>.16)for(var l=0,o=r.length;o>l;l++){var s=r[l];this.stage.reverseCheckView(s,a)||(e.beginPath(),e.fillStyle=s.color,e.moveTo(s.targetX,s.targetY),e.arc(s.targetX,s.targetY,i,0,this.pi2,!1),e.closePath(),e.fill())}else for(var c=0,h=r.length;h>c;c++){var u=r[c];this.stage.reverseCheckView(u,a)||(e.beginPath(),e.fillStyle=u.color,e.rect(~~u.targetX-i,~~u.targetY-i,i<<1,i<<1),e.closePath(),e.fill())}}}function V(e,t){if(e&&n.Xd.raw.showFood.value&&!(n.Xd.raw.autoHideFoodOnZoom.value&&this.stage.scale<.2)&&!(n.Xd.raw.autoHideFood.value&&e.playerMass>1e3))if(n.Xd.raw.rainbowFood.value)for(var a=0,r=e.foods.length;a<r;a++)this.drawCell(e.foods[a],void 0,e.unitManager.activeUnit,!1);else this.drawCachedFood(this.ctx,e,t)}function B(e,t,a){for(var r=[t.biggerHSTECellsCache,t.biggerDSTECellsCache,t.biggerSTECellsCache],i=0;i<r.length;i++)this.drawCircles(e,r[i],760,4,.4,n.rS.raw.bSTEColor.string,1);var l=t.cells;if(l.length){var o=a?l.length-1:0;e.lineWidth=6,e.globalAlpha=n.rS.raw.darkTheme.value?.7:.35,e.strokeStyle=n.rS.raw.splitRangeColor.string,e.beginPath(),e.arc(l[o].x,l[o].y,l[o].size+760,0,this.pi2,!1),e.closePath(),e.stroke()}e.globalAlpha=1}function D(e,t,a){for(var r=[t.biggerHSTECellsCache,t.biggerDSTECellsCache],i=0;i<r.length;i++)this.drawCircles(e,r[i],760,4,.4,n.rS.raw.bDSTEColor.string,2);var l=t.cells;if(l.length){var o=a?l.length-1:0;if(l[o].size*l[o].size/100<666)return;e.lineWidth=4,e.globalAlpha=n.rS.raw.darkTheme.value?.7:.35,e.strokeStyle=n.rS.raw.splitRangeColor.string,e.beginPath(),e.arc(l[o].x,l[o].y,2*l[o].size+760,0,this.pi2,!1),e.closePath(),e.stroke()}e.globalAlpha=1}function F(e,t){this.drawCircles(e,t.biggerHSTECellsCache,760,4,.4,n.rS.raw.bHSTEColor.string,3),e.globalAlpha=1}function Y(e,t,a){for(var r=14+2/t,i=12+1/t,l=[a.biggerHSTECellsCache,n.rS.raw.bHSTEColor.string,a.biggerDSTECellsCache,n.rS.raw.bDSTEColor.string,a.biggerSTECellsCache,n.rS.raw.bSTEColor.string,a.biggerCellsCache,n.rS.raw.bColor.string,a.smallerCellsCache,n.rS.raw.sColor.string,a.smallerSTECellsCache,n.rS.raw.sSTEColor.string,a.smallerDSTECellsCache,n.rS.raw.sDSTEColor.string,a.smallerHSTECellsCache,n.rS.raw.sHSTEColor.string],o=0;o<l.length;o+=2)this.drawCircles(e,l[o],r,i,.75,l[o+1],1)}function N(e,t,a,r,i,l,o){e.lineWidth=r,e.globalAlpha=i,e.strokeStyle=l;for(var s=0;s<t.length;s++)e.beginPath(),e.arc(t[s].x,t[s].y,o*t[s].size+a,0,this.pi2,!1),e.stroke(),e.closePath();e.globalAlpha=1}function U(e,t,a,r){e.lineWidth=n.rS.raw.cursorTrackingSize.value,e.strokeStyle=n.rS.raw.cursorTrackingColor.string;for(var i=0;i<t.length;i++)e.beginPath(),e.moveTo(a,r),e.lineTo(t[i].x,t[i].y),e.stroke(),e.closePath()}function L(e){var t=this,a=this.app;i.T.cleaner(),this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight),n.Xd.raw.showGrid.value&&this.drawGrid(this.ctx,this.canvasWidth,this.canvasHeight,this.stage.scale,this.stage.camera.x,this.stage.camera.y),this.ctx.save(),this.ctx.translate((~~this.canvasWidth>>1)-this.stage.camera.x*this.stage.scale,(~~this.canvasHeight>>1)-this.stage.camera.y*this.stage.scale),this.ctx.scale(this.stage.scale,this.stage.scale),":battleroyale"===this.app._server.gameMode&&this.drawBattleroyaleArea(this.ctx,a._server.mapMinX,a._server.mapMinY,a._server.mapSizeH,a._server.mapSizeV,0,0,1,1);var o=l.x.getTexture(n.rS.raw.customMapTexture.value);o&&o.image&&((!0===n.Xd.raw.showGrid.value||":battleroyale"===a._server.gameMode)&&(this.ctx.globalCompositeOperation="destination-over"),this.ctx.drawImage(o.image,~~a._server.mapMinX,~~a._server.mapMaxY,~~a._server.mapMaxX-a._server.mapMinX,~~a._server.mapMinY-a._server.mapMaxY),(!0===n.Xd.raw.showGrid.value||":battleroyale"===a._server.gameMode)&&(this.ctx.globalCompositeOperation="source-over")),!0===n.Xd.raw.showBgSectors.value&&this.drawSectors(this.ctx,!0,n.rS.raw.sectorsX.value,n.rS.raw.sectorsY.value,a._server.mapMinX,a._server.mapMinY,a._server.mapMaxX,a._server.mapMaxY,n.rS.raw.gridColor.string,n.rS.raw.sectorsColor.string,n.rS.raw.sectorsWidth.value,!0);var s=l.x.getTexture(n.rS.raw.customMapLogo.value);if(s&&s.image){var c=s.image.width,h=s.image.height,v=2.6;this.stage.isInDisplay(a._server.mapMidX-c,a._server.mapMidY-h,c*v)&&(this.ctx.globalAlpha=.2,this.ctx.drawImage(s.image,~~a._server.mapMidX-c*v>>1,~~a._server.mapMidY-h*v>>1,c*v,h*v),this.ctx.globalAlpha=1)}if(!0===n.Xd.raw.showMapBorders.value){var g=n.rS.raw.bordersWidth.value>>1;this.drawMapBorders(this.ctx,!0,a._server.mapMinX-g,a._server.mapMinY-g,a._server.mapMaxX+g,a._server.mapMaxY+g,n.rS.raw.bordersColor.string,n.rS.raw.bordersWidth.value)}!0===n.Xd.raw.virusesRange.value&&this.drawVirusesRange(this.ctx,this.stage.virusesFrame);for(var d=0,f=a.clients.player.length;f>d;d++)this.drawFood(a.clients.player[d],d);window.leaderboard&&leaderboard.ghostCells.length&&this.drawGhostCells(leaderboard);for(var p=0,y=a.unitManager.units.length;y>p;p++){var w=a.unitManager.units[p];if(w.play&&(0==p||n.Xd.raw.mbMultiSplitRange.value)&&n.Xd.raw.splitRange.value&&(this.drawSplitRange(this.ctx,w,r.d8.selectBiggestCell),n.Xd.raw.doubleSplitRange.value&&this.drawDoubleSplitRange(this.ctx,w,r.d8.selectBiggestCell),n.Xd.raw.tripleSplitRange.value&&this.drawTripleSplitRange(this.ctx,w)),w.play&&0==p&&n.Xd.raw.oppRings.value&&this.drawOppRings(this.ctx,this.stage.scale,w),n.Xd.raw.cursorTracking.value&&(w==this.app.unitManager.activeUnit||n.Xd.raw.mbMultiCursorTracking.value)){var S=w.client._cursorLocked?w.client.targetX:w.cursor.x,m=w.client._cursorLocked?w.client.targetY:w.cursor.y;this.ctx.globalAlpha=1,this.drawCursorTracking(this.ctx,w.cells,S,m)}}var b,C=this.app.unitManager.totalPlay>1,x=u(this.stage.removedCellsSet);try{for(x.s();!(b=x.n()).done;){var k=b.value;this.drawCell(k,void 0,this.app.unitManager.activeUnit,C)}}catch(e){x.e(e)}finally{x.f()}if(this.ctx.closePath(),this.ctx.globalAlpha=1,n.Xd.raw.debug.value){for(var T=0,M=a.clients.render.length;M>T;T++){var A=a.clients.render[T];this.drawViewport(this.ctx,"client "+A.ID+" - render "+A.indexPosition,A.bound.left,A.bound.bottom,A.bound.right,A.bound.top,0==A.indexPosition?"rgb(22 0 255 / 70%)":"rgb(255 0 0 / 70%)",20)}this.stage.quadtree&&(this.ctx.beginPath(),this.ctx.strokeStyle="red",this.ctx.lineWidth=2,this.ctx.globalAlpha=1,function e(a){if(t.ctx.moveTo(a.x,a.y+a.h),t.ctx.lineTo(a.x+a.w,a.y+a.h),t.ctx.lineTo(a.x+a.w,a.y),t.ctx.lineTo(a.x,a.y),a.children){var r,i=u(a.children);try{for(i.s();!(r=i.n()).done;)e(r.value)}catch(e){i.e(e)}finally{i.f()}}}(this.stage.quadtree.root),this.ctx.closePath(),this.ctx.stroke())}for(var X=0,P=this.stage.cellsFrame.length;P>X;X++)this.drawCell(this.stage.cellsFrame[X],void 0,this.app.unitManager.activeUnit,C);this.drawWaves(),this.ctx.restore()}function G(e){return~~((200-e)/14)}function Z(e){if((e=~~e)<1e3)return e;var t=(0|e/100)/10;return"".concat(t%1==0?t+".0":t,"k")}const Q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(o,e);var t,a,r,i,l=(r=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(i){var a=p(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return f(this,e)});function o(e,t){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=l.call(this,e,t)).startAlpha=1,a.pi2=2*Math.PI,a.canvas=null,a.ctx=null,a.init(),a}return t=o,(a=[{key:"init",value:y},{key:"destroy",value:w},{key:"setCanvas",value:m},{key:"setCanvasSmoothing",value:b},{key:"setCanvasAntialiasing",value:C},{key:"resizeCanvas",value:x},{key:"drawTeammatesInd",value:k},{key:"drawGrid",value:T},{key:"drawViewport",value:M},{key:"drawWaves",value:A},{key:"drawSectors",value:X},{key:"drawMapBorders",value:P},{key:"drawVirusesRange",value:_},{key:"drawBattleroyaleArea",value:z},{key:"drawDangerArea",value:R},{key:"drawSafeArea",value:O},{key:"drawDashedCircle",value:E},{key:"drawGhostCells",value:I},{key:"drawCell",value:W},{key:"drawCachedFood",value:j},{key:"drawRainbowFood",value:H},{key:"drawFood",value:V},{key:"drawSplitRange",value:B},{key:"drawDoubleSplitRange",value:D},{key:"drawTripleSplitRange",value:F},{key:"drawOppRings",value:Y},{key:"drawCircles",value:N},{key:"drawCursorTracking",value:U},{key:"render",value:L},{key:"calcVirusShots",value:G},{key:"shortMassFormat",value:Z}])&&g(t.prototype,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(s.Z)},8175:(e,t,a)=>{a.d(t,{Z:()=>b}),a(340);var r=a(8967),i=a(2267),l=a(115);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t){return n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(e,t)}function c(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function v(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function g(e){return Math.floor(e*e/100)>183?this.virus_color_danger:i.rS.raw.virusColor.microcolor}function d(e,t){return Math.floor(e*e/100)/(r.d8.selectBiggestCell?t.maxMass:t.minMass)>.76?this.virus_color_normal:this.virus_color_danger}function f(){}function p(e,t){}function y(){}function w(){this.emit("destroy"),this.unlisten()}function S(e){return e<=40||this.stage.scale<.5&&e<17/this.stage.scale}function m(e){return e<=40||this.stage.scale<.5&&e<27/this.stage.scale}const b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)}(C,e);var t,a,r,o,b=(r=C,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=u(r);if(o){var a=u(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return c(this,e)});function C(e,t){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,C),v(h(a=b.call(this)),"virus_color_danger",new l.Z(200,0,0)),v(h(a),"virus_color_normal",new l.Z(255,220,0)),v(h(a),"player_color_yellow",new l.Z(255,249,6)),a.app=e,a.stage=t,a.canvas=null,a.initialized=!1,a.listenTo(i.rS,"virusColor",(function(){a.virus_color_danger.a=i.rS.raw.virusColor.microcolor.a,a.virus_color_danger.updPacked(),a.virus_color_danger.updVector(),a.virus_color_normal.a=i.rS.raw.virusColor.microcolor.a,a.virus_color_normal.updPacked(),a.virus_color_normal.updVector()}))(),a}return t=C,(a=[{key:"setVirusColor",value:g},{key:"setVirusStrokeColor",value:d},{key:"setCanvas",value:f},{key:"resizeCanvas",value:p},{key:"init",value:y},{key:"destroy",value:w},{key:"setAutoHideCellInfoNick",value:S},{key:"setAutoHideCellInfoMass",value:m}])&&s(t.prototype,a),Object.defineProperty(t,"prototype",{writable:!1}),C}(r.aN)}}]);